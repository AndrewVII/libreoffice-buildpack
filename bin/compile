#!/bin/bash

BUILD_DIR=$1
CACHE_DIR=$2

echo "-----> Installing LibreOffice"

# URL for LibreOffice tarball (update this to the latest stable version if needed)
LIBREOFFICE_URL="https://download.documentfoundation.org/libreoffice/stable/24.8.3/deb/x86_64/LibreOffice_24.8.3_Linux_x86-64_deb.tar.gz"

# Download LibreOffice precompiled binary using curl
echo "-----> Downloading LibreOffice from $LIBREOFFICE_URL"
curl -L "$LIBREOFFICE_URL" -o /tmp/libreoffice.tar.gz

# Check if the download was successful
if [ $? -ne 0 ]; then
  echo "Error: Failed to download LibreOffice."
  exit 1
fi

# Verify that the downloaded file is a valid tar.gz archive
echo "-----> Extracting LibreOffice"
tar -xvzf /tmp/libreoffice.tar.gz -C /tmp

# Check if extraction was successful
if [ $? -ne 0 ]; then
  echo "Error: Failed to extract LibreOffice."
  exit 1
fi

# Copy the necessary LibreOffice files to the build directory
cp -r /tmp/LibreOffice*/DEBS/* $BUILD_DIR/

# Add LibreOffice binary path to the PATH environment variable
export PATH=$PATH:/tmp/LibreOffice*/program

# Final message
echo "-----> LibreOffice installation complete"
